# Milthm查分表详细说明
by PanyiAme  
2024.12.21 version 0.6.3

## 目录/Contents
- [0. 标注说明](#0-标注说明)  
- [1. 使用说明](#1-使用说明)
  - [1.1 录入成绩](#11-录入成绩v061)
    - [1.1.1 手动录入成绩](#111-手动录入成绩v061)
    - [1.1.2 上传游戏存档](#112-上传游戏存档v061)
    - [1.1.3 逐个更改成绩](#113-逐个修改成绩v052)
    - [1.1.4 转移已录入的成绩](#114-转移已录入的成绩v061)
  - [1.2 使用设置](#12-使用设置)
    - [1.2.1 基础设置](#121-基础设置v071)
    - [1.2.2 设置历史记录](#122-设置历史记录v061)
- [2. 其他说明](#2-其他说明)
  - [2.1 实验性功能](#21-实验性功能v063)
  - [2.2 联系开发者](#22-联系开发者v063)
  - [2.3 查分表复制/转载须知](#23-查分表复制转载须知v021)
- [3. 工作原理](#3-工作原理)
  - [3.1 REALITY计算](#31-reality计算v061)
  - [3.2 b20查询](#32-b20查询v010)
  - [3.3 查分图](#33-查分图v061旧版本)
  - [3.4 雷达图](#34-雷达图v063)
  - [3.5 推分建议](#35-推分建议v042)
  - [3.6 历史记录](#36-历史记录v070)
  - [3.7 上传/提取存档](#37-上传提取存档v061)
- [4. 开发者备忘录](#4-开发者备忘录)
  - [4.1 日常更新检查单](#41-日常更新检查单v070)
  - [4.2 维护更新](#42-维护更新v061)
    - [4.2.1 调试](#421-调试v061)
  - [4.3 编辑文档](#43-编辑文档v061)
  - [4.4 错误反馈记录](#44-错误反馈记录)
  - [4.5 其他备忘录](#45-其他备忘录v061)

## 0. 标注说明
每个最低级标题后的版本号为该标题下的内容的最后修改版本(修改函数位置而内容不变、修改错别字等不算)，标有"stable-"或"unstable"的表示该标题下对应的功能有将来发生较大变化的可能。  
⚠️表示未在日常更新检查单中但需要开发者特别注意的内容

## 1. 使用说明
### 1.1 录入成绩v0.6.1
截止v0.6.1，查分表共支持3种方式的成绩输入，分别为手动输入、提取游戏存档以及使用网页查分器输出的成绩信息(本文简称归梦格式)。  
游戏存档和归梦格式存在互斥，即只能输入其中一种。  
手动输入与其他两种方式不互斥，且优先级高于其他两种，即对同一谱面，同时有存档或归梦格式输入和手动输入时，采用手动输入到成绩。该设计便于用户在初次录入成绩时通过上传存档快速录入成绩，并在以后逐个更改成绩。  
录入成绩时至少需要录入分数，ACC和是否全连为选填。

#### 1.1.1 手动录入成绩v0.6.1
该方法是最稳定的输入方法，也是iOS用户唯一的输入方法，但录入完整成绩耗时较长，因此被推荐作为逐个更改成绩时的录入方法。  
手动输入成绩的步骤如下：  
1) 将I列和L列取消隐藏；  
2) 将A列按升序排列；  
3) 在Milthm中选择所有曲目预设排序；  
4) 对照Milthm逐个录入成绩。

#### 1.1.2 上传游戏存档v0.6.1
本节内容涉及游戏拆包，该内容在社区被禁止讨论，因此不建议在除Milthm查分表实验室和Milthm#√-1洨巟羣以外的场合提及本节内容。  
按如下步骤可提取存档:  
1) 用MT管理器找到.userdata，各平台下载的Milthm中该文件的路径如下:  
    Taptap:  
    /Android/data/game.taptap.morizero.milthm/files  
    game.taptap.morizero.milthm.v2.playerprefs.xml  
    /data/user/0/game.taptap.morizero.milthm/shared_prefs  
    Linux:  
    $HOME/.config/unity3d/Morizero/Milthm/  
2) 用编辑文档打开，在末尾找到TokenSession，将引号中的内容备份，改动或删除TokenSession，点击保存；  
3) 打开Milthm，在设置中点击上传存档；  
4) 在MT管理器同一路径下找到save.json；  
5) 全选复制，粘贴到查分表设置页上传存档处，注意检查是否粘贴完整。  
查分表0.6.0及以后的版本兼容归梦的网页查分器输出的存档信息，使用方法如下：  
1) 用浏览器打开http://k9.lv/c/；  
2) 按网页的说明获取存档信息；  
3) 将存档信息复制粘贴到查分表设置页上传存档处，并在存档类型处填1。

#### 1.1.3 逐个修改成绩v0.5.2
该方法与手动录入成绩步骤相似，步骤如下：  
1) 在成绩表中将N列和Q列取消隐藏；  
2) 找到要更改成绩的曲目；  
3) 在N列输入分数，在Q列输入ACC(选填)。

#### 1.1.4 转移已录入的成绩v0.6.1
从v0.5.2及更老的版本转移至新版本：将两个版本的B列取消隐藏并升序排列，框选旧版本中的成绩并复制到新版本。  
较新版本：复制旧查分表设置页提取存档处的浅红色单元格，粘贴到新查分表设置页上传存档处，并在存档类型处填1即可。

### 1.2 使用设置
#### 1.2.1 基础设置v0.7.0
a) 玩家名称  填入后将显示在查分图中。  
b) 校正REALITY  当REALITY计算误差较大时，在此格填入的REALITY数值将优先显示在查分图中。填入的REALITY需要手动更新。  
c) 推荐度偏移  推荐度偏移在v0.7.0及以后可以自动设置，但在设置时需要多次刷新。为了增加刷新次数，您可以选中一个可清除的单元格(如语言)并多次清除。在重置中输入任何内容可以将推荐度偏移归零。  
d) 语言  v0.6.3及以后的版本可设置中文和英语两种语言，英语仅部分有翻译。

#### 1.2.2 设置历史记录v0.6.1
在计时起点处填入您希望记录开始的时间，且该时间不能早于填写时的时间。

## 2. 其他说明
### 2.1 实验性功能v0.6.3
推分建议需要参考难度分布。仅给出了定数10.5及以上和部分SP难度的谱面的难度分布。  
难度分布中手法、读谱和多指根据开发者和部分用户对谱面的主观感受确定，有反馈意愿的用户被要求对要反馈的谱面按读谱、手法、多指三个维度给出评级，该评级被换算为10分制后加入难度分布的参考。您可以将成绩表T~W列取消隐藏来查看难度分布。您可以联系开发者或在查分表发布处的评论区或私信留言来给出您对难度分布的建议。  
难度分布可能在任何版本更新中变化，且不会写入更新日志。  
推分建议参考用户的REALITY、雷达图、各曲目的最大推分限度和+1000分产生的REALITY变化。这些数据以各自的系数加和得出推荐度并给出推分建议，系数由用户反馈的推分建议排序合理度迭代得出。  
同样的，这些系数可能在任何版本更新中变化且不会写入更新日志。

#### 2.2 联系开发者v0.6.3
QQ群：Milthm查分表实验室：678471942  
     Milthm#√-1洨巟羣：375882310

#### 2.3 查分表复制/转载须知v0.2.1
您可以自由复制、修改和转载该REALITY计算器，前提是您同意并遵守以下规定：  
1) 您不得将该REALITY计算器用于商业用途；  
2) 您在复制或转载该REALITY计算器时不得删除或篡改该REALITY计算器中的署名。

## 3. 工作原理
### 3.1 REALITY计算v0.6.1
单曲REALITY是单曲分数和定数的函数，计算公式如下：  
$$
\text{single.rlt}(\text{constant}, \text{score}) =
\begin{cases} 
0, & \text{score} \in [0,700000) \\
\text{constant} + f(\text{score}), & \text{score} \in [700000,1010000]
\end{cases}
$$

$$
f(\text{score}) =
\begin{cases}
-4 + \frac{\text{score}}{280000}, & \text{score} \in [700000,980000) \\
-0.5 + 0.8 \times \frac{e^{3.1 \times (\text{score} - 980000)/15000} - 1}{e^{3.1} - 1}, & \text{score} \in [980000,995000) \\
-0.4 + \frac{1.4}{1 + e^{-3.65 \times \left( \frac{\text{score} - 995000}{10000} \right) }}, & \text{score} \in [995000,1005000) \\
1, & \text{score} \in [1005000,1010000]
\end{cases}
$$

查分表中对应函数如下(以第2行为例)：  
```text
成绩表!W2=IF(P2="",0,IF(P2<995000,IF(P2<980000,IF(P2<700000,0,M2-4+P2/280000),M2-0.5+0.8*((EXP(3.1*(P2-980000)/15000)-1)/(EXP(3.1)-1))),IF(P2<1005000,M2-0.4+1.4/(EXP(-3.65*(P2/10000-99.5))+1),M2+1)))
```
该函数通过二分法对f(score)进行分段，第一级分界点为score=995000，第二级分界点为score=980000,1005000，第三级分界点为score=700000。  
对单曲REALITY进行修约的函数如下(以第2行为例)：  
```text
成绩表!V2=TEXT(MROUND(Q2,0.0001),"0.0000")
```
总REALITY是单曲REALITY最大20位的算术平均值。
计算公式如下：  
$$
\text{single.rlt}(1) \geq \text{single.rlt}(2) \geq \dots \geq \text{single.rlt}(20)
$$

$$
\text{rlt} = \frac{\sum_{i=1}^{20} \text{single.rlt}(i)}{20}
$$

查分表中对应函数如下：  
计算单曲REALITY最大20位的算数平均值并修约的函数为：  
```text
分析表!F1=TEXT(MROUND(AVERAGE(H3:H22),0.0001),"0.0000")
```
其中H3:H22是单曲REALITY最大20位的值，函数如下(以第3行为例)：  
```text
分析表!H3=IFERROR(ROUND(INDEX(成绩表!Q:Q,MATCH($A3,成绩表!R:R,0),1),4),0)
```
该函数查找并引用单曲REALITY排序与A3:A22相同的单曲REALITY数值，其中A3:A22是固定数列1,2,…,20，成绩表!Q:Q是单曲REALITY排序，函数如下(以第2行为例)：  
```text
成绩表!X2=IF(P2=0,"",RANK(W2,$W$2:$W$200,0)+COUNTIF($W$2:$W2,W2)-1)
```
该函数先找到单曲REALITY的排序(并列的取最小排序)，加上在该行上方单曲REALITY相同的数量再减1，得到唯一的单曲REALITY序列。  
⚠️开发者注意!当收录谱面数达到199张后需要将200改为更大的数值

### 3.2 b20查询v0.1.0
曲名查询通过查找和引用函数实现，函数如下(以第3行为例)：  
```text
分析表!B3=IFERROR(IF(INDEX(成绩表!$K:$K,MATCH($A3,成绩表!$R:$R,0),1)="","",INDEX(成绩表!E:E,MATCH(A3,成绩表!$R:$R,0),1)),"")
```  
当查询不到对应单曲REALITY排序的曲目时(可能原因是录入成绩的数量不够)输出为空。  
其他信息查询原理与曲名查询基本相同，但在检测到曲名为空时输出为空，函数如下(以难度第3行为例)：  
```text
分析表!C3=IFERROR(IF(INDEX(成绩表!$K:$K,MATCH($A3,成绩表!$R:$R,0),1)="","",INDEX(成绩表!F:F,MATCH(A3,成绩表!$R:$R,0),1)),"")
```  
注：这真的是查分表最稳定的功能了。


### 3.3 查分图v0.6.1(旧版本)
查分图表头显示玩家名称、REALITY、星星数量和查分图生成时间。  
玩家名称的函数显示函数如下：  
```text
查分图!G1=IF(设置!C2="","Player",设置!C2)
```
当用户在设置中填入玩家名称时显示玩家名称，否则显示"Player"。  
REALITY分为大字和小字两部分，大字精确到0.01，小字精确到0.0001。  
大字部分函数如下：  
```text
查分图!G2=IFERROR(IF(设置!C4="",INT(分析表!F1*100)/100,设置!C4),"")
```
该函数将REALITY向下修约到0.01。  
小字部分函数如下：  
```text
查分图!I2=IFERROR(IF(设置!C4="",IF(分析表!F1-G2>=0.001,MROUND(分析表!F1-G2,0.0001)*10000,0&MROUND(分析表!F1-G2,0.0001)*10000),""),"")
```
该函数将精确到0.0001的REALITY与大字部分已显示的REALITY相减并通过乘10000来去除小数点。当小字部分小于10时在小字第一位填0。  
星星数量通过判定每个谱面对应的星星数量并取最大值来显示。  
判定每个谱面的星星数量的函数如下(以第2行为例)：  
```text
成绩表!O2==IF(OR(成绩表!N2=100,K2=1010000),IF(成绩表!H2>11.9,3,IF(成绩表!H2>8.9,2,IF(成绩表!H2>5.9,1,0))),0)
```
在单曲ACC达到100%或分数达到理论值的前提下，判断谱面定数处于哪个星星数量对应的区间来判定星星数量。  
取星星数量最大值的函数如下：  
```text
计算页!H1=MAX(成绩表!O:O)
```
显示星星数量的函数如下：  
```text
查分图!K2=IFERROR(IF(计算页!H1>1,IF(计算页!H1=3,"☆☆☆","☆☆"),IF(计算页!H1=1,"☆","")),"")
```
显示查分图生成时间的函数如下：  
```text
查分图!L1=NOW()
```
查分图通过REALITY排序在分析表中检索对应谱面信息，并显示出曲名、REALITY排序、曲绘、难度、定数、分数、单曲REALITY，主要通过查找和引用函数实现。  
查找曲名的函数如下(以b1为例)：  
```text
查分图!C5=IFERROR(INDEX(分析表!$B:$B,MATCH(B5,分析表!$A:$A,0),1),"")
```
曲绘通过查找并引用曲名对应的曲绘来显示，曲绘储存在素材页。显示曲绘的函数如下：  
```text
查分图!A5=IF(C5="","?",INDEX(素材页!B:B,MATCH(C5,素材页!A:A,0),1))
```
当没有对应的曲名时曲绘显示为"?"。

### 3.4 雷达图v0.6.3
雷达图需要参考各谱面的难度分布和分数，给出单曲单维度记分，再计算各维度总分并换算为10分满分制。  
读谱、手法、多指的记分计算公式如下(以读谱为例)：
$$
\text{single.read} =
\begin{cases}
0, & \text{score} \in [0,995000) \\
\left(\frac{\text{score} - 995000}{10000}\right)^2 \times \text{distri.read}, & \text{score} \in [995000,1005000) \\
\text{distri.read}, & \text{score} \in [1005000,1010000]
\end{cases}
$$


$$
\text{single.read}(1) \geq \text{single.read}(2) \geq \dots \geq \text{single.read}(7)
$$

$$
\text{read} = \sum_{i=1}^{7} \text{single.read}(i)
$$

计算单曲单维度记分的函数如下(以第10行为例)：  
```text
成绩表!X10=IF(K10<995000,0,IF(K10<1005000,POWER((K10-995000)/10000,2)*T10,T10))
```
计算单曲单维度记分最大7位算术平均值的函数如下：  
```text
计算页!C1=AVERAGE(LARGE(成绩表!X:X,1),LARGE(成绩表!X:X,2),LARGE(成绩表!X:X,3),LARGE(成绩表!X:X,4),LARGE(成绩表!X:X,5),LARGE(成绩表!X:X,6),LARGE(成绩表!X:X,7))
```
此外，底力新标度的计算公式如下：  
$$
\text{distri.spd} = \sqrt{\text{hz} - 4} \times \ln(\text{hz} - 4) \times \sqrt{\text{time}}
$$

其中hz(频率)和time(持续时间)的计算公式如下：  
$$
\text{hz} = \frac{\text{bom} \times \text{ratio}}{60 \times \text{sint}}
$$

$$
\text{time} = \frac{\text{lasting} \times \text{sint} \times 60}{\text{bpm} \times \text{ratio}}
$$

将各维度记分换算为10分制的函数如下：  
```text
计算页!C3=70*C1/32
```
其中"32"是随难度分布变化而需要更改的。  
准度记分计算公式如下：  
$$
\text{single.accu} =
\begin{cases} 
0, & \text{if } \text{acc} = 0, \quad \text{score} \in [0,1000000] \\

\left( \frac{\text{score} - 1000000}{10000} \right)^2 \times (1 + 0.1 \times \text{constant}), & \text{score} \in (1000000,1010000] \\

0, & \text{if } \text{acc} \in (0,99) \text{ or } \text{score} \in [0,10000 \times \text{acc}] \\

0, & \text{score} \in [0,10000 \times \text{acc}] \\

\left( \frac{\text{score} - 5000 \times (\text{acc} + 100)}{10000} \right)^2 \times (1 + 0.1 \times \text{constant}), & \text{score} \in [10000 \times \text{acc},1010000]
\end{cases}
$$

计算单曲准度记分的函数如下(以第2行为例)：  
```text
成绩表!AA1=IF(VALUE(N2)=0,IF(K2>1000000,(H2*0.1+1)*POWER((K2-1000000)/10000,2),0),IF(OR(N2<99,K2<10000*N2),0,(H2*0.1+1)*POWER((K2-5000*N2-500000)/10000,2)))
```
剩余计算步骤与其他维度相同。

### 3.5 推分建议v0.4.2
推荐度考虑了用户的REALITY、雷达图与对应曲目的定数和难度分布的差距、各曲目的最大推分限度和+1000分产生的REALITY变化。  
推荐度计算公式如下：  
$$
\text{sug} = 2000 \times \text{rlt.1k} + 360 \times \text{rlt.max} - \text{dist} + \text{bias}
$$

计算推荐度的函数如下：  
```text
成绩表!AF2=2000*AE2+360*AC2-AB2+设置!$C$10
```
其中rlt.1k是将该曲目推分1000分可增加的rlt，选择考虑增加1000分是因为1000分在一般谱面中大致相当于2个good或1个miss，在推分时较为容易达到。rlt.1k的计算公式如下：  
$$
\text{rlt.1k} =
\begin{cases} 
\frac{\text{single.rlt}(\text{constant}, \text{score} + 1000) - \text{single.rlt}}{20}, & \text{if } \text{rank} < 21 \\

\frac{\text{single.rlt}(\text{constant}, \text{score} + 1000) - \text{single.rlt}(20)}{20}, & \text{otherwise}
\end{cases}
$$

函数如下：  
```text
//计算single.rlt(constant,score+1000)
成绩表!AD2=IF(K2+1000<995000,IF(K2+1000<980000,IF(K2+1000<700000,0,H2-4+(K2+1000)/280000),H2-0.5+0.8*((EXP(3.1*(K2-979000)/15000)-1)/(EXP(3.1)-1))),IF(K2<1005000,H2-0.4+1.4/(EXP(-3.65*((K2+1000)/10000-99.5))+1),H2+1))
```
计算rlt.1k的函数如下：  
```text
成绩表!AE2=IF(R2<21,(AD2-Q2)/20,(AD2-分析表!$G$22)/20)
```
函数先算出了分数增加1000分后的REALITY，再计算将该曲目的REALITY更改为rlt.1k后对总REALITY的影响。  
rlt.max是该曲目的理论REALITY，计算公式为：  
$$
\text{rlt.max} = \text{constant} + 1
$$

函数略。  
dist是该谱面的定数和难度分布与用户总体水平的不契合度，计算公式如下：  
$$
\text{dist} = \sqrt{(\text{spd} - \text{distri.spd})^2 + (\text{read} - \text{distri.read})^2 + (\text{tact} - \text{distri.tact})^2 + (\text{multi} - \text{distri.multi})^2 + (\text{rlt} - 0.25 - \text{constant})^2}
$$

函数如下：  
```text
成绩表!AB2=POWER(POWER(X2-计算页!$C$1,2)+POWER(X2-计算页!$D$1,2)+POWER(Y2-计算页!$E$1,2)+POWER(Z2-计算页!$F$1,2)+POWER(分析表!$F$1-0.25-H2,2),0.5)
```
bias是用户在设置中输入的偏移值，用于应对推分建议中的推荐度普遍偏大或偏小的情况。  
对推荐度排序，得到推分建议序列。排序的函数如下：  
```text
成绩表!AG2=IF(K2=0,"",RANK(AF2,AF:AF,0)+COUNTIF($AF$1:AF2,AF2)-1)
```
再通过查找和引用函数生成推分建议表，原理与b20查询类似。

### 3.6 历史记录v0.7.0
记录页在当前版本支持储存35天的记录，用户可以自行扩充记录区域，但会导致表格卡顿增加。  
用户输入计时起点后会在记录的第2行生成起点时间戳，每往下1行时间戳依次+1，形成参照时间戳序列。生成起点时间戳的函数如下：  
```text
记录!C2=DATE(设置!C13,设置!E13,设置!G13)*24+设置!I13
```
当现在的时间戳等于同一行的参照时间戳时，rlt记录格将复制此时的REALITY。当现在的时间戳不等于参照时间戳时，rlt记录格将复制其自身，即保持不变。rlt记录格的函数如下：  
```text
记录!D2=IF(TODAY()*24+HOUR(NOW())=C2,IF(设置!$C$4="",分析表!$F$1,设置!$C$4),D2)
```
上述记录方式得到了散点样记录，还需要转化为连续记录，补全缺失点的方案为：若此行未记录到REALITY，则尝试复制上一行的记录值，直到复制到非空记录；若此行记录到了REALITY则复制此行的记录。函数如下：  
```text
记录!G2=IFERROR(VALUE(IF(设置!$C$7=1,B2,IF(D2=0,"",D2))),0)
```
此外，为了修正REALITY历史记录图的坐标轴尺度，需要修正时间戳起点为0起点，函数如下：  
```text
记录!F3=IF(设置!$C$7=1,IF(B3=0,"",VALUE(A3-$A$2)),IF(TODAY()*24+HOUR(NOW())>=C3,F2+1,0))
```

### 3.7 上传/提取存档v0.6.1
目前查分表支持上传未解译的游戏存档(save.json)和经归梦的网页查分器解译的存档(归梦格式)，仅支持以归梦格式提取存档。  
未解译的存档中包含成绩信息的部分基本格式如下：  
```json
{"BeatmapID":"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx","BestScore":[score],"BestAccuracy":[acc],"BestLevel":[level],"AchievedStatus":[status]}
```
其中BeatmapID是谱面的唯一识别码，格式为8+4+4+4+12的16进制数码。在查分表的上传页中储存了除Welcome to Milk Rhythm(愚人节第1首)外所有谱面与BeatmapID的对应关系。  
BestLevel表示最高游玩等级，对应关系如下：  
$$
\begin{aligned}
0 & = \text{Rhythm of Rain} \quad (\text{score} = 1010000) \\
1 & = \text{All Perfect} \\
2 & = \text{Full Combo} \\
3 & = S \quad (\text{score} \in [950000,1010000)) \\
4 & = A \quad (\text{score} \in [900000,950000)) \\
5 & = B \quad (\text{score} \in [850000,900000)) \\
6 & = C \quad (\text{score} \in [800000,850000)) \\
7 & = F \quad (\text{score} \in [0,800000))
\end{aligned}
$$

查分表(转录酶)通过检索BeatmapID来定位谱面对应的成绩信息，截取BeatmapID后特定位置的若干字符，并去除多余字符，来提取分数和acc。函数如下：  
```text
上传页!E2=IFERROR(SUBSTITUTE(IF(设置!$C$19=1,MID($A$1,FIND($B2,$A$1)+LEN($B2)+1,7),MID($A$1,FIND($C2,$A$1)+LEN($C2)+14,7)),",",""),"")
```
```text
上传页!F2=IFERROR(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(IF(设置!$C$19=1,MID($A$1,FIND($B2,$A$1)+LEN($B2)+2+LEN(E2),7),MID($A$1,FIND($C2,$A$1)+LEN($C2)+30+LEN(E2),7)),",",""),"""",""),"B",""),"e",""),"")
```
经网页查分器解译输出的归梦格式如下：  
```text
[name,category,constant,score,acc,level]
```

查分表通过检索前3项来定位谱面对应的成绩信息，截取分数和acc的方法与使用未解译的存档相似，函数见第261行和第262行。  
查分表支持将以所有允许形式录入的成绩翻译为归梦格式。翻译单曲信息(核糖体)的函数如下：  
```text
成绩表!AJ2="  ["&E2&","&F2&","&TEXT(H2,"0.0")&","&K2&","&N2/100&","&AI2&"],"
```
串联所有单曲信息的函数如下(有省略)：  
```text
设置!C22="["&查分图!G1&"],"&"{"&CONCATENATE(成绩表!AJ2,…,成绩表!AJ10,成绩表!AJ11)&CONCATENATE…&"}"
```

## 4. 开发者备忘录
### 4.1 日常更新检查单v0.7.0
1) 根据更新的曲目复制成绩表中对应行  
2) 输入曲目信息：  
    a) 曲名、曲包等筛选信息  
    b) 收录序列  
    c) BeatmapID  
    d) 难度、定数  
3) 在核糖体中串联上新曲的成绩信息  
4) 在计算页中扩展rlt-定数图的制图区域  
5) 在素材页中上传曲绘  
6) 调试

### 4.2 维护更新v0.6.1
开发者需要确保理解该查分表的逻辑结构，根据用户反馈和已发现的问题进行维护。如果解决了所有已知影响使用的问题则可以发布稳定版本，并在原版号第三位+1。如果还有未解决的影响使用的问题则发布不稳定版本，并将存在问题的位置标黄，版号规则为：[上一个稳定版本的版号]d[从上一个稳定版本发布到该版本的天数]v[今天之内发布不稳定版本的序号]，例如：v0.6.1d6v2  
有较大功能变化的更新需要将版号第2位+1并将第3位清零。

#### 4.2.1 调试v0.6.1
发布稳定版本前需要进行调试。调试成绩录入的步骤如下：  
1) 手动输入：全理论、全100w、全99w、全97w  
2) 上传存档：全理论、样品存档(可以用自己的)  
每次调试注意REALITY计算值正确、查分表显示无异常  
调试提取存档：  
将提取出的存档输入网页查分器，对照REALITY和成绩信息  
调试历史记录：  
1) 录入当前的时间  
2) 填入一个REALITY  
3) 将填入的时间向前位移一点(几小时或一天)  
重复2)和3)6次，检查REALITY历史

### 4.3 编辑文档v0.6.1
当查分表功能发生变化时需要修改文档。文档字数不应超过1200字或45行(不含致谢名单)。  
简要说明应至少包含上传存档、手动输入、转移存档的方法。当前UI虽然有防呆，但用户仍然可能误操作覆盖有函数的单元格，应当在文档中提醒用户。

### 4.4 错误反馈记录
说明：  
修复状态描述如下：  
- unfixed: 未修复  
- unstable: 仅进行了临时修复，该问题可能重复出现  
- stable-: 该问题被解决并能正确运行，但易形成屎山  
- stable: 该问题被解决且运行良好，暂时无重构需求(在下一个版本删除反馈记录)  

反馈记录：  
1 241215T1726 0301  
REALITY图标显示错误  
重新上传了图标文件  
unstable  

2 241215T2014 0300  
非WPS使用查分表时曲绘显示错误  
更换了部分曲绘来源  
添加了素材的下载链接  
stable-  

5 241217T1032 0300  
Welcome to Milthm曲绘不能显示  
纠正了素材页的曲名  
stable  

### 4.5 其他备忘录v0.6.1
为了避免用户修改存档不当导致存档损坏，查分表不能将逆转录酶加入到用户可轻易找到的位置，但可以放在隐藏的表格中。  
查分表的文件大小应尽量控制在7.5MB以内，可以通过压缩曲绘来缩小体积。

